import{_ as n,c as a,e as t,o as s}from"./app-BTrhkc6v.js";const i={};function o(r,e){return s(),a("div",null,e[0]||(e[0]=[t(`<h2 id="_1-dude-how-is-your-next-hop-the-upstream" tabindex="-1"><a class="header-anchor" href="#_1-dude-how-is-your-next-hop-the-upstream"><span>1. Dude, How Is Your Next Hop the Upstream?</span></a></h2><p><a href="https://pysio.blog/notes/a7u2jlwwrd490031" target="_blank" rel="noopener noreferrer">2025/5/15 Original Post</a></p><p>After helping AS208754 debug for 2 hours, we discovered his next hop was actually the upstream!</p><div class="language-text" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> Why isn&#39;t my prefix exported to upstream? Upstream Import 0</span>
<span class="line"> Friend: If nothing works, try &quot;all&quot;</span>
<span class="line"> OK</span>
<span class="line"> Upstream: Import 0</span>
<span class="line"> Friend: That&#39;s weird, try xxxx</span>
<span class="line"></span></code></pre></div><p>His Bird Config turned out to be:</p><div class="language-conf" data-highlighter="prismjs" data-ext="conf"><pre><code class="language-conf"><span class="line">protocol static {</span>
<span class="line">    ipv6;</span>
<span class="line">    route &lt;prefix&gt;::/44 via fd00:2::1</span>
<span class="line">}</span>
<span class="line"></span></code></pre></div><p>Well, let&#39;s explain what happened:</p><p>In this BGP session, <code>fd00:2::1</code> is the upstream&#39;s address, but obviously he statically specified the next hop route as the upstream address, which created a loop. Of course Bird went on strike!</p><h2 id="_2-massive-withdrawal-updates" tabindex="-1"><a class="header-anchor" href="#_2-massive-withdrawal-updates"><span>2. Massive Withdrawal Updates</span></a></h2><p><a href="https://pysio.blog/notes/a81vh2qounpi0033" target="_blank" rel="noopener noreferrer">2025/5/22 Original Post</a></p><p>Due to BuyVM&#39;s problematic LU network, it caused massive withdrawal updates as shown below:</p><div class="language-bash" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">    Routes:         <span class="token number">1</span> imported, <span class="token number">213789</span> exported, <span class="token number">1</span> preferred</span>
<span class="line">    Route change stats:     received   rejected   filtered    ignored   accepted</span>
<span class="line">      Import updates:           <span class="token number">6295</span>          <span class="token number">0</span>          <span class="token number">0</span>          <span class="token number">5</span>       <span class="token number">6290</span></span>
<span class="line">      Import withdraws:            <span class="token number">0</span>          <span class="token number">0</span>        ---          <span class="token number">0</span>       <span class="token number">6289</span></span>
<span class="line">      Export updates:     <span class="token number">1340353503</span>      <span class="token number">12530</span>      <span class="token number">19382</span>        --- <span class="token number">1340321591</span></span>
<span class="line">      Export withdraws:        <span class="token number">16719</span>        ---        ---        ---       <span class="token number">9950</span></span>
<span class="line"></span></code></pre></div><h2 id="_3-dn42-ip-mcdonald-s-random-config" tabindex="-1"><a class="header-anchor" href="#_3-dn42-ip-mcdonald-s-random-config"><span>3. DN42 IP McDonald&#39;s Random Config</span></a></h2><p><a href="https://pysio.blog/notes/a8346q5ounpi004y" target="_blank" rel="noopener noreferrer">2025/5/22 Original Post</a></p><p>While everyone in the group was helping @Alice_8585@baka.ink figure out why his BGP configuration wasn&#39;t correctly exporting IPv4 prefixes, we saw this WireGuard configuration:</p><div class="language-bash" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token number">3</span>: pyiso: <span class="token operator">&lt;</span>POINTOPOINT,NOARP,UP,LOWER_UP<span class="token operator">&gt;</span> mtu <span class="token number">1420</span> qdisc noqueue state UNKNOWN group default qlen <span class="token number">1000</span></span>
<span class="line">    link/none</span>
<span class="line">    inet <span class="token number">172.20</span>.44.131 peer <span class="token number">172.20</span>.183.3/32 scope global pyiso</span>
<span class="line">       valid_lft forever preferred_lft forever</span>
<span class="line">    inet6 fe80::440/64 scope <span class="token function">link</span></span>
<span class="line">       valid_lft forever preferred_lft forever</span>
<span class="line"><span class="token number">4</span>: lezi: <span class="token operator">&lt;</span>POINTOPOINT,NOARP,UP,LOWER_UP<span class="token operator">&gt;</span> mtu <span class="token number">1420</span> qdisc noqueue state UNKNOWN group default qlen <span class="token number">1000</span></span>
<span class="line">    link/none</span>
<span class="line">    inet <span class="token number">172.20</span>.44.132 peer <span class="token number">172.22</span>.137.99/32 scope global lezi</span>
<span class="line">       valid_lft forever preferred_lft forever</span>
<span class="line">    inet6 fe80::387/64 scope <span class="token function">link</span></span>
<span class="line">       valid_lft forever preferred_lft forever</span>
<span class="line"></span></code></pre></div><p>Did everyone notice what went wrong? That&#39;s right! He configured different IP addresses for different WireGuard tunnels, which is not allowed in DN42...</p><details class="hint-container details"><summary>Attached is a post from STE</summary><p>You mean, we can&#39;t ping each other, constantly checking birdc, bird.conf, BGP status, almost considering whether the network on your side is being continuously irradiated by cosmic rays causing bit flips and packet explosion, while your WireGuard peer was filled with a random IP?</p><p>You mean, the BIRD configuration has a neighbor address written as one IP address, the WireGuard configuration has another, and another interface has yet another, and then you say there&#39;s nothing wrong, making us debug like we&#39;re solving riddles?</p><p>You mean, you turned the WireGuard tunnel into a maze? Making our traceroute feel like exploring unknown universes?</p><p>This isn&#39;t just a regular tunnel anymore, it&#39;s a random address generator. Even if IETF came, they couldn&#39;t explain why your BGP won&#39;t start.</p><p>8585&#39;s WireGuard interface, configuration file, and BIRD&#39;s neighbor IP configuration used three different IPs, which was the main reason we wasted a lot of time troubleshooting network connectivity issues.</p><p>VPN, especially WireGuard, a P2P protocol, has very strict requirements for IP consistency on both sides. It&#39;s not like regular Ethernet that relies on broadcast as a fallback. Wrong IP configuration means complete disconnection, and any subsequent optimization is futile.</p><p>I suggest that in the future when configuring VPN and BIRD-related interface addresses, paste all detailed information to some website to greatly save troubleshooting costs.</p><p>The internet is really fun</p></details><h2 id="_4-wireguard-is-sleeping" tabindex="-1"><a class="header-anchor" href="#_4-wireguard-is-sleeping"><span>4. WireGuard Is Sleeping!</span></a></h2><p><a href="https://pysio.blog/notes/a839ueoounpi005f" target="_blank" rel="noopener noreferrer">2025/5/23 Original Post</a></p><p>Yes, after we spent half an hour studying why the WireGuard tunnel wasn&#39;t working, a casual ping discovered it was actually reachable...</p><p>This teaches us not to judge whether there&#39;s a handshake by looking at WireGuard&#39;s last handshake, because it might very well be slacking off.</p><p>Just send any packet and it starts working again. Very magical.</p><h2 id="_5-dude-where-is-your-route6" tabindex="-1"><a class="header-anchor" href="#_5-dude-where-is-your-route6"><span>5. Dude, Where is your Route6?</span></a></h2><p>Once again, it&#39;s AS208754, After discovering that her /48 prefix was unpingable, she came to the group for help.</p><div class="language-text" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"></span>
<span class="line">AS208754: Why can&#39;t anyone ping my /48 from China? Is it blocked by the GFW?</span>
<span class="line"></span>
<span class="line">Group friend: What heinous thing did you do to get your /48 blocked by the GFW!?</span>
<span class="line"></span>
<span class="line">AS208754: WTF</span>
<span class="line"></span>
<span class="line">(After a long debugging)</span>
<span class="line"></span>
<span class="line">Upstream: Import 0</span>
<span class="line"></span>
<span class="line">Upstream: Where&#39;s your route6?</span>
<span class="line"></span>
<span class="line"></span></code></pre></div><p>After explanations from group friends, it turned out that they had only configured rDNS for the /48 prefix that day, but forgot to set up route6. The filter it.</p><p>This incident teaches us: Always double-check before configuring anything. Make sure everything is verified before deploying, and never blindly push changes into the production environment.</p>`,28)]))}const l=n(i,[["render",o]]),c=JSON.parse(`{"path":"/en/posts/daily/AKIXAccident.html","title":"AKIX Incident Compilation","lang":"en-US","frontmatter":{"title":"AKIX Incident Compilation","date":"2025-05-26T00:00:00.000Z","icon":"fa-kit fa-wireshark","category":"daily","tag":["BGP","Daily"],"description":"1. Dude, How Is Your Next Hop the Upstream? 2025/5/15 Original Post After helping AS208754 debug for 2 hours, we discovered his next hop was actually the upstream! His Bird Conf...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"AKIX Incident Compilation\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2025-05-26T00:00:00.000Z\\",\\"dateModified\\":\\"2025-06-07T05:38:43.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Pysio\\",\\"url\\":\\"https://github.com/pysio2007/\\"}]}"],["meta",{"property":"og:url","content":"https://www.pysio.online/en/posts/daily/AKIXAccident.html"}],["meta",{"property":"og:site_name","content":"Pysio's Home"}],["meta",{"property":"og:title","content":"AKIX Incident Compilation"}],["meta",{"property":"og:description","content":"1. Dude, How Is Your Next Hop the Upstream? 2025/5/15 Original Post After helping AS208754 debug for 2 hours, we discovered his next hop was actually the upstream! His Bird Conf..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:locale:alternate","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-06-07T05:38:43.000Z"}],["meta",{"property":"article:tag","content":"Daily"}],["meta",{"property":"article:tag","content":"BGP"}],["meta",{"property":"article:published_time","content":"2025-05-26T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-06-07T05:38:43.000Z"}],["link",{"rel":"alternate","hreflang":"zh-cn","href":"https://www.pysio.online/posts/daily/AKIXAccident.html"}],["meta",{"property":"article:published_time","content":"2025-05-26T00:00:00.000Z"}],["meta",{"name":"article:published_time","content":"2025-05-26T00:00:00.000Z"}],["meta",{"property":"article:tag","content":"BGP"}],["meta",{"property":"article:tag","content":"Daily"}],["meta",{"property":"article:section","content":"daily"}],["meta",{"property":"og:title","content":"AKIX Incident Compilation"}],["meta",{"property":"og:url","content":"https://www.pysio.online/en/posts/daily/AKIXAccident.html"}],["meta",{"property":"og:description","content":"1. Dude, How Is Your Next Hop the Upstream? 2025/5/15 Original Post After helping AS208754 debug for 2 hours, we discovered his next hop was actually the upstream! His Bird Conf..."}],["meta",{"name":"description","content":"1. Dude, How Is Your Next Hop the Upstream? 2025/5/15 Original Post After helping AS208754 debug for 2 hours, we discovered his next hop was actually the upstream! His Bird Conf..."}],["meta",{"name":"twitter:title","content":"AKIX Incident Compilation"}],["meta",{"name":"twitter:description","content":"1. Dude, How Is Your Next Hop the Upstream? 2025/5/15 Original Post After helping AS208754 debug for 2 hours, we discovered his next hop was actually the upstream! His Bird Conf..."}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"BlogPosting\\",\\"headline\\":\\"AKIX Incident Compilation\\",\\"author\\":{\\"@type\\":\\"Person\\",\\"name\\":\\"Pysio\\",\\"url\\":\\"https://github.com/pysio2007\\"},\\"publisher\\":{\\"@type\\":\\"Organization\\",\\"name\\":\\"Pysio's Home\\",\\"url\\":\\"https://www.pysio.online\\"},\\"url\\":\\"https://www.pysio.online/en/posts/daily/AKIXAccident.html\\",\\"datePublished\\":\\"2025-05-26T00:00:00.000Z\\",\\"dateModified\\":\\"2025-05-26T00:00:00.000Z\\",\\"description\\":\\"1. Dude, How Is Your Next Hop the Upstream? 2025/5/15 Original Post After helping AS208754 debug for 2 hours, we discovered his next hop was actually the upstream! His Bird Conf...\\",\\"mainEntityOfPage\\":{\\"@type\\":\\"WebPage\\",\\"@id\\":\\"https://www.pysio.online/en/posts/daily/AKIXAccident.html\\"}}"],["link",{"rel":"canonical","href":"https://www.pysio.online/en/posts/daily/AKIXAccident.html"}],["link",{"rel":"alternate","type":"application/rss+xml","title":"Pysio's Home RSS Feed","href":"https://www.pysio.online/rss.xml"}],["meta",{"property":"og:title","content":"AKIX Incident Compilation"}],["meta",{"property":"og:description","content":"1. Dude, How Is Your Next Hop the Upstream? 2025/5/15 Original Post After helping AS208754 debug for 2 hours, we discovered his next hop was actually the upstream! His Bird Conf..."}],["meta",{"property":"og:image","content":"https://www.pysio.online/og-images/akix-incident-compilation.png"}],["meta",{"property":"og:url","content":"https://www.pysio.online/en/posts/daily/AKIXAccident.html"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:site_name","content":"Pysio's Home"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:title","content":"AKIX Incident Compilation"}],["meta",{"name":"twitter:description","content":"1. Dude, How Is Your Next Hop the Upstream? 2025/5/15 Original Post After helping AS208754 debug for 2 hours, we discovered his next hop was actually the upstream! His Bird Conf..."}],["meta",{"name":"twitter:image","content":"https://www.pysio.online/og-images/akix-incident-compilation.png"}],["link",{"rel":"alternate","type":"application/rss+xml","href":"https://www.pysio.online/en/rss.xml","title":"Pysio's Home RSS Feed"}]]},"git":{"createdTime":1748736273000,"updatedTime":1749274723000,"contributors":[{"name":"pysio2007","username":"pysio2007","email":"71202163+pysio2007@users.noreply.github.com","commits":1,"url":"https://github.com/pysio2007"},{"name":"9Bakabaka","username":"9Bakabaka","email":"140469824+9Bakabaka@users.noreply.github.com","commits":1,"url":"https://github.com/9Bakabaka"}]},"readingTime":{"minutes":2.58,"words":773},"filePathRelative":"en/posts/daily/AKIXAccident.md","excerpt":"<h2>1. Dude, How Is Your Next Hop the Upstream?</h2>\\n<p><a href=\\"https://pysio.blog/notes/a7u2jlwwrd490031\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">2025/5/15 Original Post</a></p>\\n<p>After helping AS208754 debug for 2 hours, we discovered his next hop was actually the upstream!</p>\\n<div class=\\"language-text\\" data-highlighter=\\"prismjs\\" data-ext=\\"text\\"><pre><code class=\\"language-text\\"><span class=\\"line\\"> Why isn't my prefix exported to upstream? Upstream Import 0</span>\\n<span class=\\"line\\"> Friend: If nothing works, try \\"all\\"</span>\\n<span class=\\"line\\"> OK</span>\\n<span class=\\"line\\"> Upstream: Import 0</span>\\n<span class=\\"line\\"> Friend: That's weird, try xxxx</span>\\n<span class=\\"line\\"></span></code></pre>\\n</div>","autoDesc":true}`);export{l as comp,c as data};
