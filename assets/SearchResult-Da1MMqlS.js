import{p as j,f as ee,q as se,t as M,v as te,x as le,y as ae,z as ie,A as Q,g as R,B as re,w as ue,C as t,D as oe,R as T,E as ne,F as ce,G as he,H as me,I as ve,J as pe,j as de,K as ye,L as ge,M as k,N as Ee,O as Ae,P as Be,Q as fe,S as G,T as O,U as He}from"./app-iArzjX2e.js";const Re=["/","/dn42.html","/intro.html","/Game/2048.html","/Game/GameofLife.html","/Game/Langtonsant.html","/Game/wordle.html","/other/cc.html","/other/friends.html","/other/githubpulls.html","/other/issues.html","/other/status.html","/tools/Pastebin.html","/tools/ipcheck.html","/posts/NekoXii/Crazy.html","/posts/daily/Destiny%20Year7.html","/posts/daily/GTNH.html","/posts/daily/Gitlab%20Pollution.html","/posts/daily/HuoShen80Hub.html","/posts/daily/OpenBmclapi.html","/posts/daily/PWA.html","/posts/daily/WordPress%20to%20VuePress.html","/posts/daily/bye2024.html","/posts/develop/1Panel%20Redis%20Object%20Cache.html","/posts/develop/Blog%20Architecture.html","/posts/develop/Enabling%20the%20xterm.js%20console%20for%20OpenSuse%20in%20PVE%20.html","/posts/develop/Manual%20merge%20Pull%20requests.html","/posts/develop/NewBlog.html","/posts/develop/OpenMCIM.html","/posts/develop/Public%20DNS%20DOH.html","/posts/develop/Remove%20Pve%20No%20valid%20subscription.html","/posts/develop/api.html","/posts/develop/icon.html","/posts/develop/randomimage.html","/posts/resource/ThatTimeIGotReincarnatedasaSlime.html","/404.html","/Game/","/other/","/tools/","/posts/NekoXii/","/posts/","/posts/daily/","/posts/develop/","/posts/resource/","/category/","/category/nekoxii/","/category/daily/","/category/develop/","/category/resource/","/tag/","/tag/nekoxii/","/tag/crazy/","/tag/%E5%91%BD%E8%BF%902/","/tag/%E6%97%A5%E5%B8%B8/","/tag/gtnh/","/tag/%E7%81%AB%E7%A5%9E/","/tag/pwa/","/tag/wordpress/","/tag/%E8%B7%A8%E5%B9%B4/","/tag/1panel/","/tag/%E5%8D%9A%E5%AE%A2%E5%BC%80%E5%8F%91/","/tag/pve/","/tag/opensuse/","/tag/git/","/tag/%E5%8D%9A%E5%AE%A2/","/tag/next.js/","/tag/mc/","/tag/%E6%9C%8D%E5%8A%A1/","/tag/dns/","/tag/api/","/tag/fontawesome/","/tag/%E9%9A%8F%E6%9C%BA%E5%9B%BE%E7%89%87/","/tag/%E8%B5%84%E6%BA%90%E5%88%86%E4%BA%AB/","/tag/%E5%85%B3%E4%BA%8E%E6%88%91%E8%BD%AC%E7%94%9F%E5%8F%98%E6%88%90%E5%8F%B2%E8%8E%B1%E5%A7%86%E8%BF%99%E6%A1%A3%E4%BA%8B/","/tag/%E8%BD%BB%E5%B0%8F%E8%AF%B4/","/article/","/star/","/timeline/"],ke="SLIMSEARCH_QUERY_HISTORY",y=j(ke,[]),we=()=>{const{queryHistoryCount:l}=k,a=l>0;return{enabled:a,queryHistories:y,addQueryHistory:i=>{a&&(y.value=Array.from(new Set([i,...y.value.slice(0,l-1)])))},removeQueryHistory:i=>{y.value=[...y.value.slice(0,i),...y.value.slice(i+1)]}}},F=l=>Re[l.id]+("anchor"in l?`#${l.anchor}`:""),Ce="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:$}=k,g=j(Ce,[]),xe=()=>{const l=$>0;return{enabled:l,resultHistories:g,addResultHistory:a=>{if(l){const i={link:F(a),display:a.display};"header"in a&&(i.header=a.header),g.value=[i,...g.value.slice(0,$-1)]}},removeResultHistory:a=>{g.value=[...g.value.slice(0,a),...g.value.slice(a+1)]}}},De=l=>{const a=me(),i=M(),w=ve(),u=Q(0),A=R(()=>u.value>0),p=pe([]);return de(()=>{const{search:d,terminate:C}=ye(),E=ge(n=>{const{resultsFilter:B=o=>o,querySplitter:L,suggestionsFilter:x,...D}=a.value;n?(u.value+=1,d(n,i.value,D).then(o=>B(o,n,i.value,w.value)).then(o=>{u.value-=1,p.value=o}).catch(o=>{console.warn(o),u.value-=1,u.value||(p.value=[])})):p.value=[]},k.searchDelay-k.suggestDelay,{maxWait:5e3});Ee([l,i],([n])=>E(n.join(" "))),Ae(()=>{C()})}),{isSearching:A,results:p}};var be=ee({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:a}){const i=se(),w=M(),u=te(le),{enabled:A,addQueryHistory:p,queryHistories:d,removeQueryHistory:C}=we(),{enabled:E,resultHistories:n,addResultHistory:B,removeResultHistory:L}=xe(),x=A||E,D=ae(l,"queries"),{results:o,isSearching:N}=De(D),r=ie({isQuery:!0,index:0}),m=Q(0),v=Q(0),P=R(()=>x&&(d.value.length>0||n.value.length>0)),S=R(()=>o.value.length>0),b=R(()=>o.value[m.value]||null),U=()=>{const{isQuery:e,index:s}=r;s===0?(r.isQuery=!e,r.index=e?n.value.length-1:d.value.length-1):r.index=s-1},Y=()=>{const{isQuery:e,index:s}=r;s===(e?d.value.length-1:n.value.length-1)?(r.isQuery=!e,r.index=0):r.index=s+1},_=()=>{m.value=m.value>0?m.value-1:o.value.length-1,v.value=b.value.contents.length-1},z=()=>{m.value=m.value<o.value.length-1?m.value+1:0,v.value=0},V=()=>{v.value<b.value.contents.length-1?v.value+=1:z()},W=()=>{v.value>0?v.value-=1:_()},q=e=>e.map(s=>He(s)?s:t(s[0],s[1])),X=e=>{if(e.type==="customField"){const s=Be[e.index]||"$content",[c,H=""]=fe(s)?s[w.value].split("$content"):s.split("$content");return e.display.map(h=>t("div",q([c,...h,H])))}return e.display.map(s=>t("div",q(s)))},f=()=>{m.value=0,v.value=0,a("updateQuery",""),a("close")},J=()=>A?t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},u.value.queryHistory),d.value.map((e,s)=>t("div",{class:["slimsearch-result-item",{active:r.isQuery&&r.index===s}],onClick:()=>{a("updateQuery",e)}},[t(G,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},e),t("button",{class:"slimsearch-remove-icon",innerHTML:O,onClick:c=>{c.preventDefault(),c.stopPropagation(),C(s)}})]))])):null,K=()=>E?t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},u.value.resultHistory),n.value.map((e,s)=>t(T,{to:e.link,class:["slimsearch-result-item",{active:!r.isQuery&&r.index===s}],onClick:()=>{f()}},()=>[t(G,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(c=>q(c)).flat())]),t("button",{class:"slimsearch-remove-icon",innerHTML:O,onClick:c=>{c.preventDefault(),c.stopPropagation(),L(s)}})]))])):null;return re("keydown",e=>{if(l.isFocusing){if(S.value){if(e.key==="ArrowUp")W();else if(e.key==="ArrowDown")V();else if(e.key==="Enter"){const s=b.value.contents[v.value];p(l.queries.join(" ")),B(s),i.push(F(s)),f()}}else if(E){if(e.key==="ArrowUp")U();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const{index:s}=r;r.isQuery?(a("updateQuery",d.value[s]),e.preventDefault()):(i.push(n.value[s].link),f())}}}}),ue([m,v],()=>{var e;(e=document.querySelector(".slimsearch-result-list-item.active .slimsearch-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["slimsearch-result-wrapper",{empty:l.queries.length?!S.value:!P.value}],id:"slimsearch-results"},l.queries.length?N.value?t(oe,{hint:u.value.searching}):S.value?t("ul",{class:"slimsearch-result-list"},o.value.map(({title:e,contents:s},c)=>{const H=m.value===c;return t("li",{class:["slimsearch-result-list-item",{active:H}]},[t("div",{class:"slimsearch-result-title"},e||u.value.defaultTitle),s.map((h,Z)=>{const I=H&&v.value===Z;return t(T,{to:F(h),class:["slimsearch-result-item",{active:I,"aria-selected":I}],onClick:()=>{p(l.queries.join(" ")),B(h),f()}},()=>[h.type==="text"?null:t(h.type==="title"?ne:h.type==="heading"?ce:he,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[h.type==="text"&&h.header?t("div",{class:"content-header"},h.header):null,t("div",X(h))])])})])})):u.value.emptyResult:x?P.value?[J(),K()]:u.value.emptyHistory:u.value.emptyResult)}});export{be as default};
