import{p as M,f as ee,q as se,t as j,v as te,x as le,y as ae,z as ie,A as B,g as w,B as re,w as ue,C as t,D as oe,R as G,E as ne,F as ce,G as he,H as ve,I as me,J as pe,j as de,K as ye,L as ge,M as A,N as fe,O as Ee,P as He,Q as ke,S as O,T,U as Re}from"./app-Dz6WBbcw.js";const we=["/","/intro.html","/Game/2048.html","/Game/GameofLife.html","/Game/Langtonsant.html","/Game/wordle.html","/other/cc.html","/other/friends.html","/other/githubpulls.html","/other/issues.html","/other/status.html","/tools/Pastebin.html","/tools/ipcheck.html","/posts/NekoXii/Crazy.html","/posts/daily/Destiny%20Year7.html","/posts/daily/GTNH.html","/posts/daily/Gitlab%20Pollution.html","/posts/daily/HuoShen80Hub.html","/posts/daily/OpenBmclapi.html","/posts/daily/PWA.html","/posts/daily/WordPress%20to%20VuePress.html","/posts/daily/bye2024.html","/posts/develop/1Panel%20Redis%20Object%20Cache.html","/posts/develop/Blog%20Architecture.html","/posts/develop/Enabling%20the%20xterm.js%20console%20for%20OpenSuse%20in%20PVE%20.html","/posts/develop/Manual%20merge%20Pull%20requests.html","/posts/develop/OpenMCIM.html","/posts/develop/Public%20DNS%20DOH.html","/posts/develop/Remove%20Pve%20No%20valid%20subscription.html","/posts/develop/api.html","/posts/develop/icon.html","/posts/develop/randomimage.html","/404.html","/Game/","/other/","/tools/","/posts/NekoXii/","/posts/","/posts/daily/","/posts/develop/","/category/","/category/nekoxii/","/category/daily/","/category/develop/","/tag/","/tag/nekoxii/","/tag/crazy/","/tag/%E5%91%BD%E8%BF%902/","/tag/%E6%97%A5%E5%B8%B8/","/tag/gtnh/","/tag/%E7%81%AB%E7%A5%9E/","/tag/pwa/","/tag/wordpress/","/tag/%E8%B7%A8%E5%B9%B4/","/tag/1panel/","/tag/%E5%8D%9A%E5%AE%A2%E5%BC%80%E5%8F%91/","/tag/pve/","/tag/opensuse/","/tag/git/","/tag/mc/","/tag/%E6%9C%8D%E5%8A%A1/","/tag/dns/","/tag/api/","/tag/fontawesome/","/tag/%E9%9A%8F%E6%9C%BA%E5%9B%BE%E7%89%87/","/article/","/star/","/timeline/"],Ae="SLIMSEARCH_QUERY_HISTORY",y=M(Ae,[]),Ce=()=>{const{queryHistoryCount:l}=A,a=l>0;return{enabled:a,queryHistories:y,addQueryHistory:i=>{a&&(y.value=Array.from(new Set([i,...y.value.slice(0,l-1)])))},removeQueryHistory:i=>{y.value=[...y.value.slice(0,i),...y.value.slice(i+1)]}}},L=l=>we[l.id]+("anchor"in l?`#${l.anchor}`:""),xe="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:$}=A,g=M(xe,[]),Se=()=>{const l=$>0;return{enabled:l,resultHistories:g,addResultHistory:a=>{if(l){const i={link:L(a),display:a.display};"header"in a&&(i.header=a.header),g.value=[i,...g.value.slice(0,$-1)]}},removeResultHistory:a=>{g.value=[...g.value.slice(0,a),...g.value.slice(a+1)]}}},be=l=>{const a=ve(),i=j(),C=me(),u=B(0),E=w(()=>u.value>0),p=pe([]);return de(()=>{const{search:d,terminate:x}=ye(),f=ge(n=>{const{resultsFilter:H=o=>o,querySplitter:P,suggestionsFilter:S,...b}=a.value;n?(u.value+=1,d(n,i.value,b).then(o=>H(o,n,i.value,C.value)).then(o=>{u.value-=1,p.value=o}).catch(o=>{console.warn(o),u.value-=1,u.value||(p.value=[])})):p.value=[]},A.searchDelay-A.suggestDelay,{maxWait:5e3});fe([l,i],([n])=>f(n.join(" "))),Ee(()=>{x()})}),{isSearching:E,results:p}};var De=ee({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:a}){const i=se(),C=j(),u=te(le),{enabled:E,addQueryHistory:p,queryHistories:d,removeQueryHistory:x}=Ce(),{enabled:f,resultHistories:n,addResultHistory:H,removeResultHistory:P}=Se(),S=E||f,b=ae(l,"queries"),{results:o,isSearching:N}=be(b),r=ie({isQuery:!0,index:0}),v=B(0),m=B(0),F=w(()=>S&&(d.value.length>0||n.value.length>0)),q=w(()=>o.value.length>0),D=w(()=>o.value[v.value]||null),U=()=>{const{isQuery:e,index:s}=r;s===0?(r.isQuery=!e,r.index=e?n.value.length-1:d.value.length-1):r.index=s-1},Y=()=>{const{isQuery:e,index:s}=r;s===(e?d.value.length-1:n.value.length-1)?(r.isQuery=!e,r.index=0):r.index=s+1},_=()=>{v.value=v.value>0?v.value-1:o.value.length-1,m.value=D.value.contents.length-1},z=()=>{v.value=v.value<o.value.length-1?v.value+1:0,m.value=0},V=()=>{m.value<D.value.contents.length-1?m.value+=1:z()},W=()=>{m.value>0?m.value-=1:_()},Q=e=>e.map(s=>Re(s)?s:t(s[0],s[1])),X=e=>{if(e.type==="customField"){const s=He[e.index]||"$content",[c,R=""]=ke(s)?s[C.value].split("$content"):s.split("$content");return e.display.map(h=>t("div",Q([c,...h,R])))}return e.display.map(s=>t("div",Q(s)))},k=()=>{v.value=0,m.value=0,a("updateQuery",""),a("close")},J=()=>E?t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},u.value.queryHistory),d.value.map((e,s)=>t("div",{class:["slimsearch-result-item",{active:r.isQuery&&r.index===s}],onClick:()=>{a("updateQuery",e)}},[t(O,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},e),t("button",{class:"slimsearch-remove-icon",innerHTML:T,onClick:c=>{c.preventDefault(),c.stopPropagation(),x(s)}})]))])):null,K=()=>f?t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},u.value.resultHistory),n.value.map((e,s)=>t(G,{to:e.link,class:["slimsearch-result-item",{active:!r.isQuery&&r.index===s}],onClick:()=>{k()}},()=>[t(O,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(c=>Q(c)).flat())]),t("button",{class:"slimsearch-remove-icon",innerHTML:T,onClick:c=>{c.preventDefault(),c.stopPropagation(),P(s)}})]))])):null;return re("keydown",e=>{if(l.isFocusing){if(q.value){if(e.key==="ArrowUp")W();else if(e.key==="ArrowDown")V();else if(e.key==="Enter"){const s=D.value.contents[m.value];p(l.queries.join(" ")),H(s),i.push(L(s)),k()}}else if(f){if(e.key==="ArrowUp")U();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const{index:s}=r;r.isQuery?(a("updateQuery",d.value[s]),e.preventDefault()):(i.push(n.value[s].link),k())}}}}),ue([v,m],()=>{var e;(e=document.querySelector(".slimsearch-result-list-item.active .slimsearch-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["slimsearch-result-wrapper",{empty:l.queries.length?!q.value:!F.value}],id:"slimsearch-results"},l.queries.length?N.value?t(oe,{hint:u.value.searching}):q.value?t("ul",{class:"slimsearch-result-list"},o.value.map(({title:e,contents:s},c)=>{const R=v.value===c;return t("li",{class:["slimsearch-result-list-item",{active:R}]},[t("div",{class:"slimsearch-result-title"},e||u.value.defaultTitle),s.map((h,Z)=>{const I=R&&m.value===Z;return t(G,{to:L(h),class:["slimsearch-result-item",{active:I,"aria-selected":I}],onClick:()=>{p(l.queries.join(" ")),H(h),k()}},()=>[h.type==="text"?null:t(h.type==="title"?ne:h.type==="heading"?ce:he,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[h.type==="text"&&h.header?t("div",{class:"content-header"},h.header):null,t("div",X(h))])])})])})):u.value.emptyResult:S?F.value?[J(),K()]:u.value.emptyHistory:u.value.emptyResult)}});export{De as default};
