import{q as e,g as s,t,v as l,x as a,P as r,y as i,z as o,A as u,h as n,B as c,w as p,C as v,D as h,R as d,E as y,F as m,G as g,H,I as f,J as E,k,K as x,L as Q,M as R,N as A,O as w,Q as C,S as q,T as S,U as b}from"./app-8nOVpml8.js";const D=["/","/intro.html","/Game/GameofLife.html","/Game/Langtonsant.html","/Game/wordle.html","/other/cc.html","/other/friends.html","/other/githubpulls.html","/other/issues.html","/tools/ipcheck.html","/posts/NekoXii/Crazy.html","/posts/daily/Destiny%20Year7.html","/posts/daily/Gitlab%20Pollution.html","/posts/daily/HuoShen80Hub.html","/posts/daily/OpenBmclapi.html","/posts/daily/PWA.html","/posts/daily/WordPress%20to%20VuePress.html","/posts/develop/1Panel%20Redis%20Object%20Cache.html","/posts/develop/Enabling%20the%20xterm.js%20console%20for%20OpenSuse%20in%20PVE%20.html","/posts/develop/Manual%20merge%20Pull%20requests.html","/posts/develop/OpenMCIM.html","/posts/develop/Public%20DNS%20DOH.html","/posts/develop/Remove%20Pve%20No%20valid%20subscription.html","/posts/develop/icon.html","/posts/develop/randomimage.html","/404.html","/Game/","/other/","/tools/","/posts/NekoXii/","/posts/","/posts/daily/","/posts/develop/","/category/","/category/nekoxii/","/category/daily/","/category/develop/","/tag/","/tag/nekoxii/","/tag/crazy/","/tag/%E5%91%BD%E8%BF%902/","/tag/%E6%97%A5%E5%B8%B8/","/tag/%E7%81%AB%E7%A5%9E/","/tag/pwa/","/tag/wordpress/","/tag/1panel/","/tag/pve/","/tag/opensuse/","/tag/git/","/tag/mc/","/tag/%E6%9C%8D%E5%8A%A1/","/tag/dns/","/tag/fontawesome/","/tag/%E9%9A%8F%E6%9C%BA%E5%9B%BE%E7%89%87/","/article/","/star/","/timeline/"],P=e("SEARCH_PRO_QUERY_HISTORY",[]),B=e=>D[e.id]+("anchor"in e?`#${e.anchor}`:""),{resultHistoryCount:O}=R,F=e("SEARCH_PRO_RESULT_HISTORY",[]);var j=s({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(e,{emit:s}){const D=t(),j=l(),G=a(r),{enabled:T,addQueryHistory:L,queryHistory:M,removeQueryHistory:_}=(()=>{const{queryHistoryCount:e}=R,s=e>0;return{enabled:s,queryHistory:P,addQueryHistory:t=>{s&&(P.value=Array.from(new Set([t,...P.value.slice(0,e-1)])))},removeQueryHistory:e=>{P.value=[...P.value.slice(0,e),...P.value.slice(e+1)]}}})(),{enabled:I,resultHistory:N,addResultHistory:U,removeResultHistory:Y}=(()=>{const e=O>0;return{enabled:e,resultHistory:F,addResultHistory:s=>{if(e){const e={link:B(s),display:s.display};"header"in s&&(e.header=s.header),F.value=[e,...F.value.slice(0,O-1)]}},removeResultHistory:e=>{F.value=[...F.value.slice(0,e),...F.value.slice(e+1)]}}})(),$=T||I,z=i(e,"queries"),{results:V,isSearching:W}=(e=>{const s=H(),t=l(),a=f(),r=u(0),i=n((()=>r.value>0)),o=E([]);return k((()=>{const{search:l,terminate:i}=x(),u=Q((e=>{const i=e.join(" "),{searchFilter:u=e=>e,splitWord:n,suggestionsFilter:c,...p}=s.value;i?(r.value+=1,l(e.join(" "),t.value,p).then((e=>u(e,i,t.value,a.value))).then((e=>{r.value-=1,o.value=e})).catch((e=>{r.value-=1,r.value||(o.value=[])}))):o.value=[]}),R.searchDelay-R.suggestDelay);p([e,t],(([e])=>u(e)),{immediate:!0}),A((()=>{i()}))})),{isSearching:i,results:o}})(z),X=o({isQuery:!0,index:0}),J=u(0),K=u(0),Z=n((()=>$&&(M.value.length>0||N.value.length>0))),ee=n((()=>V.value.length>0)),se=n((()=>V.value[J.value]||null)),te=e=>e.map((e=>b(e)?e:v(e[0],e[1]))),le=e=>{if("customField"===e.type){const s=w[e.index]||"$content",[t,l=""]=C(s)?s[j.value].split("$content"):s.split("$content");return e.display.map((e=>v("div",te([t,...e,l]))))}return e.display.map((e=>v("div",te(e))))},ae=()=>{J.value=0,K.value=0,s("updateQuery",""),s("close")};return c("keydown",(t=>{if(e.isFocusing)if(ee.value){if("ArrowUp"===t.key)K.value>0?K.value-=1:(J.value=J.value>0?J.value-1:V.value.length-1,K.value=se.value.contents.length-1);else if("ArrowDown"===t.key)K.value<se.value.contents.length-1?K.value+=1:(J.value=J.value<V.value.length-1?J.value+1:0,K.value=0);else if("Enter"===t.key){const s=se.value.contents[K.value];L(e.queries.join(" ")),U(s),D.push(B(s)),ae()}}else if(I)if("ArrowUp"===t.key)(()=>{const{isQuery:e,index:s}=X;0===s?(X.isQuery=!e,X.index=e?N.value.length-1:M.value.length-1):X.index=s-1})();else if("ArrowDown"===t.key)(()=>{const{isQuery:e,index:s}=X;s===(e?M.value.length-1:N.value.length-1)?(X.isQuery=!e,X.index=0):X.index=s+1})();else if("Enter"===t.key){const{index:e}=X;X.isQuery?(s("updateQuery",M.value[e]),t.preventDefault()):(D.push(N.value[e].link),ae())}})),p([J,K],(()=>{var e;null==(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))||e.scrollIntoView(!1)}),{flush:"post"}),()=>v("div",{class:["search-pro-result-wrapper",{empty:e.queries.length?!ee.value:!Z.value}],id:"search-pro-results"},e.queries.length?W.value?v(h,{hint:G.value.searching}):ee.value?v("ul",{class:"search-pro-result-list"},V.value.map((({title:s,contents:t},l)=>{const a=J.value===l;return v("li",{class:["search-pro-result-list-item",{active:a}]},[v("div",{class:"search-pro-result-title"},s||G.value.defaultTitle),t.map(((s,t)=>{const l=a&&K.value===t;return v(d,{to:B(s),class:["search-pro-result-item",{active:l,"aria-selected":l}],onClick:()=>{L(e.queries.join(" ")),U(s),ae()}},(()=>["text"===s.type?null:v("title"===s.type?y:"heading"===s.type?m:g,{class:"search-pro-result-type"}),v("div",{class:"search-pro-result-content"},["text"===s.type&&s.header?v("div",{class:"content-header"},s.header):null,v("div",le(s))])]))}))])}))):G.value.emptyResult:$?Z.value?[T?v("ul",{class:"search-pro-result-list"},v("li",{class:"search-pro-result-list-item"},[v("div",{class:"search-pro-result-title"},G.value.queryHistory),M.value.map(((e,t)=>v("div",{class:["search-pro-result-item",{active:X.isQuery&&X.index===t}],onClick:()=>{s("updateQuery",e)}},[v(q,{class:"search-pro-result-type"}),v("div",{class:"search-pro-result-content"},e),v("button",{class:"search-pro-remove-icon",innerHTML:S,onClick:e=>{e.preventDefault(),e.stopPropagation(),_(t)}})])))])):null,I?v("ul",{class:"search-pro-result-list"},v("li",{class:"search-pro-result-list-item"},[v("div",{class:"search-pro-result-title"},G.value.resultHistory),N.value.map(((e,s)=>v(d,{to:e.link,class:["search-pro-result-item",{active:!X.isQuery&&X.index===s}],onClick:()=>{ae()}},(()=>[v(q,{class:"search-pro-result-type"}),v("div",{class:"search-pro-result-content"},[e.header?v("div",{class:"content-header"},e.header):null,v("div",e.display.map((e=>te(e))).flat())]),v("button",{class:"search-pro-remove-icon",innerHTML:S,onClick:e=>{e.preventDefault(),e.stopPropagation(),Y(s)}})]))))])):null]:G.value.emptyHistory:G.value.emptyResult)}});export{j as default};