import{f as J,p as M,q as K,t as Z,v as ee,x as se,y as q,g as H,z as t,A as te,B as le,w as ae,C as ie,R as P,D as re,E as oe,F as ue,G as ne,H as ce,I,J as T,K as he,L as me,M as ve,j as pe,N as de,O as ye,P as ge,Q as Ee,S as O,T as Ae,U as C}from"./app-DWcQK1lD.js";const Be=["/","/intro.html","/Game/2048.html","/Game/GameofLife.html","/Game/Langtonsant.html","/Game/wordle.html","/other/cc.html","/other/friends.html","/other/githubpulls.html","/other/issues.html","/other/status.html","/tools/Pastebin.html","/tools/ipcheck.html","/posts/NekoXii/Crazy.html","/posts/daily/AnyCast.html","/posts/daily/Destiny%20Year7.html","/posts/daily/Dstiny2Macro.html","/posts/daily/GTNH.html","/posts/daily/Gitlab%20Pollution.html","/posts/daily/HuoShen80Hub.html","/posts/daily/OpenBmclapi.html","/posts/daily/PWA.html","/posts/daily/WordPress%20to%20VuePress.html","/posts/daily/bye2024.html","/posts/daily/day250215.html","/posts/develop/1Panel%20Redis%20Object%20Cache.html","/posts/develop/Blog%20Architecture.html","/posts/develop/Enabling%20the%20xterm.js%20console%20for%20OpenSuse%20in%20PVE%20.html","/posts/develop/Manual%20merge%20Pull%20requests.html","/posts/develop/NewBlog.html","/posts/develop/OpenMCIM.html","/posts/develop/Public%20DNS%20DOH.html","/posts/develop/Remove%20Pve%20No%20valid%20subscription.html","/posts/develop/api.html","/posts/develop/icon.html","/posts/develop/randomimage.html","/posts/resource/ThatTimeIGotReincarnatedasaSlime.html","/404.html","/Game/","/other/","/tools/","/posts/NekoXii/","/posts/","/posts/daily/","/posts/develop/","/posts/resource/","/category/","/category/nekoxii/","/category/daily/","/category/develop/","/category/resource/","/tag/","/tag/nekoxii/","/tag/crazy/","/tag/bgp/","/tag/%E6%97%A5%E5%B8%B8/","/tag/%E5%91%BD%E8%BF%902/","/tag/gtnh/","/tag/%E7%81%AB%E7%A5%9E/","/tag/pwa/","/tag/wordpress/","/tag/%E8%B7%A8%E5%B9%B4/","/tag/%E5%8D%9A%E5%AE%A2%E5%BC%80%E5%8F%91/","/tag/1panel/","/tag/pve/","/tag/opensuse/","/tag/git/","/tag/%E5%8D%9A%E5%AE%A2/","/tag/next.js/","/tag/mc/","/tag/%E6%9C%8D%E5%8A%A1/","/tag/dns/","/tag/api/","/tag/fontawesome/","/tag/%E9%9A%8F%E6%9C%BA%E5%9B%BE%E7%89%87/","/tag/%E8%B5%84%E6%BA%90%E5%88%86%E4%BA%AB/","/tag/%E5%85%B3%E4%BA%8E%E6%88%91%E8%BD%AC%E7%94%9F%E5%8F%98%E6%88%90%E5%8F%B2%E8%8E%B1%E5%A7%86%E8%BF%99%E6%A1%A3%E4%BA%8B/","/tag/%E8%BD%BB%E5%B0%8F%E8%AF%B4/","/article/","/star/","/timeline/"],fe="SLIMSEARCH_QUERY_HISTORY",y=O(fe,[]),He=()=>{const{queryHistoryCount:a}=C;return{enabled:a>0,queryHistories:y,addQueryHistory:o=>{y.value=Array.from(new Set([o,...y.value.slice(0,a-1)]))},removeQueryHistory:o=>{y.value=[...y.value.slice(0,o),...y.value.slice(o+1)]}}},Q=a=>Be[a.id]+("anchor"in a?`#${a.anchor}`:""),Ce="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:G}=C,g=O(Ce,[]),ke=()=>({enabled:G>0,resultHistories:g,addResultHistory:r=>{{const o={link:Q(r),display:r.display};"header"in r&&(o.header=r.header),g.value=[o,...g.value.slice(0,G-1)]}},removeResultHistory:r=>{g.value=[...g.value.slice(0,r),...g.value.slice(r+1)]}}),Re=a=>{const r=he(),o=M(),k=me(),u=q(0),E=H(()=>u.value>0),h=ve([]);return pe(()=>{const{search:R,terminate:v}=de(),A=ge(p=>{const{resultsFilter:w=l=>l,querySplitter:d,suggestionsFilter:b,...i}=r.value;p?(u.value+=1,R(p,o.value,i).then(l=>w(l,p,o.value,k.value)).then(l=>{u.value-=1,h.value=l}).catch(l=>{console.warn(l),u.value-=1,u.value||(h.value=[])})):h.value=[]},C.searchDelay-C.suggestDelay,{maxWait:5e3});ye([a,o],([p])=>A(p.join(" "))),Ee(()=>{v()})}),{isSearching:E,results:h}};var De=J({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:r}){const o=le(),k=M(),u=K(Z),{addQueryHistory:E,queryHistories:h,removeQueryHistory:R}=He(),{resultHistories:v,addResultHistory:A,removeResultHistory:p}=ke(),w=ee(a,"queries"),{results:d,isSearching:b}=Re(w),i=se({isQuery:!0,index:0}),l=q(0),m=q(0),F=H(()=>h.value.length>0||v.value.length>0),D=H(()=>d.value.length>0),x=H(()=>d.value[l.value]||null),$=()=>{const{isQuery:e,index:s}=i;s===0?(i.isQuery=!e,i.index=e?v.value.length-1:h.value.length-1):i.index=s-1},j=()=>{const{isQuery:e,index:s}=i;s===(e?h.value.length-1:v.value.length-1)?(i.isQuery=!e,i.index=0):i.index=s+1},N=()=>{l.value=l.value>0?l.value-1:d.value.length-1,m.value=x.value.contents.length-1},U=()=>{l.value=l.value<d.value.length-1?l.value+1:0,m.value=0},Y=()=>{m.value<x.value.contents.length-1?m.value+=1:U()},_=()=>{m.value>0?m.value-=1:N()},S=e=>e.map(s=>Ae(s)?s:t(s[0],s[1])),z=e=>{if(e.type==="customField"){const s=ne[e.index]||"$content",[n,f=""]=ce(s)?s[k.value].split("$content"):s.split("$content");return e.display.map(c=>t("div",S([n,...c,f])))}return e.display.map(s=>t("div",S(s)))},B=()=>{l.value=0,m.value=0,r("updateQuery",""),r("close")},V=()=>t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},u.value.queryHistory),h.value.map((e,s)=>t("div",{class:["slimsearch-result-item",{active:i.isQuery&&i.index===s}],onClick:()=>{r("updateQuery",e)}},[t(I,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},e),t("button",{class:"slimsearch-remove-icon",innerHTML:T,onClick:n=>{n.preventDefault(),n.stopPropagation(),R(s)}})]))])),W=()=>t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},u.value.resultHistory),v.value.map((e,s)=>t(P,{to:e.link,class:["slimsearch-result-item",{active:!i.isQuery&&i.index===s}],onClick:()=>{B()}},()=>[t(I,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(n=>S(n)).flat())]),t("button",{class:"slimsearch-remove-icon",innerHTML:T,onClick:n=>{n.preventDefault(),n.stopPropagation(),p(s)}})]))]));return te("keydown",e=>{if(a.isFocusing){if(D.value){if(e.key==="ArrowUp")_();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const s=x.value.contents[m.value];E(a.queries.join(" ")),A(s),o.push(Q(s)),B()}}else if(e.key==="ArrowUp")$();else if(e.key==="ArrowDown")j();else if(e.key==="Enter"){const{index:s}=i;i.isQuery?(r("updateQuery",h.value[s]),e.preventDefault()):(o.push(v.value[s].link),B())}}}),ae([l,m],()=>{var e;(e=document.querySelector(".slimsearch-result-list-item.active .slimsearch-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["slimsearch-result-wrapper",{empty:a.queries.length?!D.value:!F.value}],id:"slimsearch-results"},a.queries.length?b.value?t(ie,{hint:u.value.searching}):D.value?t("ul",{class:"slimsearch-result-list"},d.value.map(({title:e,contents:s},n)=>{const f=l.value===n;return t("li",{class:["slimsearch-result-list-item",{active:f}]},[t("div",{class:"slimsearch-result-title"},e||u.value.defaultTitle),s.map((c,X)=>{const L=f&&m.value===X;return t(P,{to:Q(c),class:["slimsearch-result-item",{active:L,"aria-selected":L}],onClick:()=>{E(a.queries.join(" ")),A(c),B()}},()=>[c.type==="text"?null:t(c.type==="title"?re:c.type==="heading"?oe:ue,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[c.type==="text"&&c.header?t("div",{class:"content-header"},c.header):null,t("div",z(c))])])})])})):u.value.emptyResult:F.value?[V(),W()]:u.value.emptyHistory)}});export{De as default};
