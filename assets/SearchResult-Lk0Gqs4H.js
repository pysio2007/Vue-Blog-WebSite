import{g as K,q as M,s as X,t as Z,v as ee,x as se,y as Q,h as H,z as e,A as te,B as le,l as ae,C as re,R as P,D as oe,E as ie,F as ue,G as ce,H as ne,I as T,J as G,K as de,L as he,M as me,k as ve,N as pe,O as ye,P as ge,Q as Ee,S as O,T as Ae,U as b}from"./app-CmvMGGR8.js";const Be=["/","/intro.html","/Game/2048.html","/Game/GameofLife.html","/Game/Langtonsant.html","/Game/wordle.html","/other/cc.html","/other/friends.html","/other/githubpulls.html","/other/issues.html","/other/status.html","/tools/Pastebin.html","/tools/ipcheck.html","/posts/daily/AnyCast.html","/posts/daily/Destiny%20Year7.html","/posts/daily/Dstiny2Macro.html","/posts/daily/GTNH.html","/posts/daily/Gitlab%20Pollution.html","/posts/daily/HuoShen80Hub.html","/posts/daily/OpenBmclapi.html","/posts/daily/PWA.html","/posts/daily/RegistryASN.html","/posts/daily/WordPress%20to%20VuePress.html","/posts/daily/bye2024.html","/posts/daily/day250215.html","/posts/develop/1Panel%20Redis%20Object%20Cache.html","/posts/develop/Blog%20Architecture.html","/posts/develop/Enabling%20the%20xterm.js%20console%20for%20OpenSuse%20in%20PVE%20.html","/posts/develop/Manual%20merge%20Pull%20requests.html","/posts/develop/NewBlog.html","/posts/develop/OpenMCIM.html","/posts/develop/Public%20DNS%20DOH.html","/posts/develop/Remove%20Pve%20No%20valid%20subscription.html","/posts/develop/api.html","/posts/develop/freecdn.html","/posts/develop/icon.html","/posts/develop/randomimage.html","/posts/resource/ThatTimeIGotReincarnatedasaSlime.html","/404.html","/Game/","/other/","/tools/","/posts/daily/","/posts/","/posts/develop/","/posts/resource/","/category/","/category/daily/","/category/develop/","/category/resource/","/tag/","/tag/bgp/","/tag/%E6%97%A5%E5%B8%B8/","/tag/%E5%91%BD%E8%BF%902/","/tag/gtnh/","/tag/%E7%81%AB%E7%A5%9E/","/tag/pwa/","/tag/wordpress/","/tag/%E8%B7%A8%E5%B9%B4/","/tag/%E5%8D%9A%E5%AE%A2%E5%BC%80%E5%8F%91/","/tag/1panel/","/tag/pve/","/tag/opensuse/","/tag/git/","/tag/%E5%8D%9A%E5%AE%A2/","/tag/next.js/","/tag/mc/","/tag/%E6%9C%8D%E5%8A%A1/","/tag/dns/","/tag/api/","/tag/fontawesome/","/tag/%E9%9A%8F%E6%9C%BA%E5%9B%BE%E7%89%87/","/tag/%E8%B5%84%E6%BA%90%E5%88%86%E4%BA%AB/","/tag/%E5%85%B3%E4%BA%8E%E6%88%91%E8%BD%AC%E7%94%9F%E5%8F%98%E6%88%90%E5%8F%B2%E8%8E%B1%E5%A7%86%E8%BF%99%E6%A1%A3%E4%BA%8B/","/tag/%E8%BD%BB%E5%B0%8F%E8%AF%B4/","/article/","/star/","/timeline/"],fe="SLIMSEARCH_QUERY_HISTORY",g=O(fe,[]),He=()=>{const{queryHistoryCount:a}=b;return{enabled:a>0,queryHistories:g,addQueryHistory:u=>{g.value=Array.from(new Set([u,...g.value.slice(0,a-1)]))},removeQueryHistory:u=>{g.value=[...g.value.slice(0,u),...g.value.slice(u+1)]}}},k=a=>Be[a.id]+("anchor"in a?`#${a.anchor}`:""),be="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:I}=b,E=O(be,[]),Re=()=>({enabled:I>0,resultHistories:E,addResultHistory:i=>{{const u={link:k(i),display:i.display};"header"in i&&(u.header=i.header),E.value=[u,...E.value.slice(0,I-1)]}},removeResultHistory:i=>{E.value=[...E.value.slice(0,i),...E.value.slice(i+1)]}}),Se=a=>{const i=de(),u=M(),R=he(),r=Q(0),A=H(()=>r.value>0),d=me([]);return ve(()=>{const{search:S,terminate:v}=pe(),B=ge(p=>{const{resultsFilter:w=l=>l,querySplitter:y,suggestionsFilter:q,...o}=i.value;p?(r.value+=1,S(p,u.value,o).then(l=>w(l,p,u.value,R.value)).then(l=>{r.value-=1,d.value=l}).catch(l=>{console.warn(l),r.value-=1,r.value||(d.value=[])})):d.value=[]},b.searchDelay-b.suggestDelay,{maxWait:5e3});ye([a,u],([p])=>B(p.join(" "))),Ee(()=>{v()})}),{isSearching:A,results:d}};var xe=K({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:i}){const u=le(),R=M(),r=X(Z),{addQueryHistory:A,queryHistories:d,removeQueryHistory:S}=He(),{resultHistories:v,addResultHistory:B,removeResultHistory:p}=Re(),w=ee(a,"queries"),{results:y,isSearching:q}=Se(w),o=se({isQuery:!0,index:0}),l=Q(0),h=Q(0),F=H(()=>d.value.length>0||v.value.length>0),x=H(()=>y.value.length>0),C=H(()=>y.value[l.value]||null),$=()=>{const{isQuery:s,index:t}=o;t===0?(o.isQuery=!s,o.index=s?v.value.length-1:d.value.length-1):o.index=t-1},j=()=>{const{isQuery:s,index:t}=o;t===(s?d.value.length-1:v.value.length-1)?(o.isQuery=!s,o.index=0):o.index=t+1},N=()=>{l.value=l.value>0?l.value-1:y.value.length-1,h.value=C.value.contents.length-1},U=()=>{l.value=l.value<y.value.length-1?l.value+1:0,h.value=0},Y=()=>{h.value<C.value.contents.length-1?h.value+=1:U()},_=()=>{h.value>0?h.value-=1:N()},D=s=>s.map(t=>Ae(t)?t:e(t[0],t[1])),V=s=>{if(s.type==="customField"){const t=ce[s.index]||"$content",[m,c=""]=ne(t)?t[R.value].split("$content"):t.split("$content");return s.display.map(n=>e("div",D([m,...n,c])))}return s.display.map(t=>e("div",D(t)))},f=()=>{l.value=0,h.value=0,i("updateQuery",""),i("close")},W=()=>e("div",{class:"slimsearch-records"},e("div",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},r.value.queryHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},d.value.map((s,t)=>{const m=o.isQuery&&o.index===t;return e("li",{class:["slimsearch-record-matches",{active:m}],role:"option","aria-selected":m,onClick:()=>{i("updateQuery",s)}},e("div",[e(T,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},s),e("button",{type:"button",class:"slimsearch-remove-icon",title:r.value.remove,"aria-label":r.value.remove,innerHTML:G,onClick:c=>{c.preventDefault(),c.stopPropagation(),S(t)}})]))}))])),z=()=>e("ul",{class:"slimsearch-records"},e("li",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},r.value.resultHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},v.value.map((s,t)=>{const m=!o.isQuery&&o.index===t;return e("li",{class:["slimsearch-record-matches",{active:m}],role:"option","aria-selected":m},e(P,{to:s.link,onClick:()=>{f()}},()=>[e(T,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[s.header?e("div",{class:"slimsearch-record-content-header"},s.header):null,e("div",s.display.map(c=>D(c)).flat())]),e("button",{type:"button",class:"slimsearch-remove-icon",title:r.value.remove,"aria-label":r.value.remove,innerHTML:G,onClick:c=>{c.preventDefault(),c.stopPropagation(),p(t)}})]))}))]));return te("keydown",s=>{if(a.isFocusing){if(x.value){if(s.key==="ArrowUp")_();else if(s.key==="ArrowDown")Y();else if(s.key==="Enter"){const t=C.value.contents[h.value];A(a.queries.join(" ")),B(t),u.push(k(t)),f()}}else if(s.key==="ArrowUp")$();else if(s.key==="ArrowDown")j();else if(s.key==="Enter"){const{index:t}=o;o.isQuery?(s.preventDefault(),i("updateQuery",d.value[t])):(u.push(v.value[t].link),f())}}}),ae([l,h],()=>{var s;(s=document.querySelector(".slimsearch-record.active .slimsearch-record-matches.active"))==null||s.scrollIntoView(!1)},{flush:"post"}),()=>e("div",{id:"slimsearch-results",class:["slimsearch-result-wrapper",{empty:a.queries.length?!x.value:!F.value}]},a.queries.length?q.value?e(re,{hint:r.value.searching}):x.value?e("div",{class:"slimsearch-records",role:"listbox","aria-labeledby":"slimsearch-label"},y.value.map(({title:s,contents:t},m)=>{const c=l.value===m;return e("div",{class:["slimsearch-record",{active:c}],role:"group","aria-selected":c},[e("div",{class:"slimsearch-record-title"},s||r.value.defaultTitle),e("ul",{class:"slimsearch-record-contents"},t.map((n,J)=>{const L=c&&h.value===J;return e("li",{class:["slimsearch-record-matches",{active:L}],role:"option","aria-selected":L},e(P,{to:k(n),onClick:()=>{A(a.queries.join(" ")),B(n),f()}},()=>[n.type==="text"?null:e(n.type==="title"?oe:n.type==="heading"?ie:ue,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[n.type==="text"&&n.header?e("div",{class:"slimsearch-record-content-header"},n.header):null,e("div",V(n))])]))}))])})):r.value.emptyResult:F.value?[W(),z()]:r.value.emptyHistory)}});export{xe as default};
